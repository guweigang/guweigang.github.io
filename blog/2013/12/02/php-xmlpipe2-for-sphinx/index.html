<!DOCTYPE html>
<html lang="en-us">
<head>
  <title>PHP xmlpipe2 for sphinx indexes - Gu Weigang</title>
  <meta charset="utf-8" />
  <meta name="author" content="Gu Weigang" />
  <meta name="description" content="使用XMLPIPE2方式创建sphinx索引" />
  <meta name="keywords" content="php, xmlpipe, sphinx" />

  <link rel="alternate" title="RSS Feed" href="/rss.xml" type="application/rss+xml">

  <link rel="stylesheet" href="/media/css/main.css" type="text/css">
  <link rel="stylesheet" href="/media/css/prettify.css" type="text/css">
</head>

  <body class="container">
<header id="header">
  <h1 class="title"><a href="/">Gu Weigang</a></h1>
  <ul>
    <li><a href="/blog/">Blog</a></li>
    <li><a href="/tags/">Tags</a></li>
    <li><a href="/about/">About</a></li>
  </ul>
  <form method="get" id="search" action="https://duckduckgo.com">
    <input type="text" class="field" name="q" id="s" placeholder="Search">
    <input type="hidden" name="q" value="site:guweigang.com">
  </form>
</header>

<section id="content" role="main">
  <h1>PHP xmlpipe2 for sphinx indexes</h1>
  <style type="text/css">
table {
line-height: 1.5 !important;
}
.gist {
font-size: 14px;
}
</style>

<p>
Sphinx的索引源可以有很多种格式：
</p>
<ul class="org-ul">
<li>mysql
</li>
<li>pgsql
</li>
<li>mssql
</li>
<li>xmlpipe
</li>
<li>xmlpipe2
</li>
<li>odbc
</li>
</ul>

<p>
对于简单的数据需求，我们可以直接使用mysql, pgsql等Sphinx内置的源数据拉取工具，但是有些时候在生成索引之前是需要复杂计算和逻辑处理的，这样的话就不得不使用xmlpipe接口了，先看Sphinx的配置，：
</p>

<div class="org-src-container">

<pre class="src src-WinConf">source products                                                    
{                                                                  
    type              = xmlpipe2                                   
    xmlpipe_command   = php /home/work/tmp/xmlpipe2.php

}
</pre>
</div>

<p>
再来看相应的PHP写的满足Sphinx XMLPIPE2接口要求的代码：
</p>

<script src="https://gist.github.com/guweigang/7745073.js"></script>

</section>



<footer id="footer">
    Send comments, critique and suggestions to <a href="mailto:guweigang &lt;at&gt; outlook &lt;dot&gt; com">Gu Weigang</a>.
    Powered by <a href="https://github.com/kelvinh/org-page">org-page</a>
</footer>

  </body>
</html>
